<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Environmental Preservation Calculator | ArchiveSense</title>
  <meta name="description" content="Estimate preservation lifetime multipliers for collectibles using temperature and relative humidity, based on conservation science models." />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-4G8EHH040J"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());
    gtag('config', 'G-4G8EHH040J');
  </script>

  <!-- Microsoft Clarity -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "sw5s6gwxlx");
  </script>

  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>

    .content { 
      max-width: 960px; 
      margin: 0 auto; 
      padding: 2.5rem 1rem; 
    }

    .intro-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      padding: 2.25rem 1.5rem;
      margin-bottom: 2rem;
    }
    .intro-card h2 { 
      color: var(--accent-color); 
      font-size: 1.65rem; 
      margin: 0 0 .65rem;
      display: flex;
      align-items: center;
      gap: .5rem;
    }
    .intro-card p { 
      margin: 0; 
      font-size: 1.05rem; 
      line-height: 1.7;
      color: var(--primary-text);
    }

    .calculator {
      display: grid;
      grid-template-columns: 1fr 1.2fr;
      gap: 2rem;
    }

    /* Environmental Inputs - Prominent */
    .environmental-inputs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-bottom: 1.5rem;
      padding: 1.5rem;
      background: var(--secondary-bg);
      border-radius: 8px;
      border: 2px solid var(--accent-color);
    }

    .environmental-inputs .field {
      margin: 0;
      display: flex;
      flex-direction: column;
    }

    .environmental-inputs .field label {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent-color);
      margin-bottom: 0.75rem;
      display: block;
    }

    /* Remove up/down arrows from number inputs */
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    input[type="number"] {
      -moz-appearance: textfield;
      appearance: textfield;
    }

    .row {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 1rem;
      align-items: center;
    }

    .card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      padding: 1.5rem;
      position: relative;
    }

    .card h2 { 
      margin: 0 0 1rem; 
      font-size: 1.5rem; 
      color: var(--accent-color); 
      display: flex;
      align-items: center;
      gap: .5rem;
    }
    .card h2::before {
      font-size: 1.75rem;
      line-height: 1;
    }
    .inputs-card h2::before { content: "üìù"; }
    .results-card h2::before { content: "üìä"; }

    .field { margin: 1.1rem 0; }
    .field label { 
      display: flex;
      align-items: center;
      gap: .4rem;
      margin-bottom: .45rem;
      font-weight: 700;
      font-size: 1.05rem;
    }
    .field label::before {
      font-size: 1.15rem;
    }
    .material-label::before { content: "üóÇÔ∏è"; }
    .temp-label::before { content: "üå°Ô∏è"; }
    .rh-label::before { content: "üíß"; }
    .field small { color: var(--secondary-text); font-size: .9rem; line-height: 1.4; }

    select, input[type="number"] {
      width: 100%;
      padding: .75rem .8rem;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      font-size: 1.05rem;
      background: #fff;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    select:focus, input[type="number"]:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(184, 124, 92, 0.1);
    }

    .units { display: flex; gap: .5rem; background: var(--secondary-bg); padding: .5rem; border-radius: 6px; }
    .units label { 
      display: inline-flex; 
      align-items: center; 
      gap: .35rem; 
      font-size: .95rem; 
      color: var(--secondary-text);
      cursor: pointer;
      padding: .25rem .5rem;
      border-radius: 4px;
      transition: background 0.2s;
    }
    .units label:has(input:checked) {
      background: var(--accent-color);
      color: #fff;
      font-weight: 600;
    }

    button.calculate {
      width: 100%;
      padding: 1rem;
      background: var(--accent-color);
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.15rem;
      font-weight: 600;
      transition: transform 0.1s, box-shadow 0.2s;
      box-shadow: 0 2px 6px rgba(184, 124, 92, 0.3);
    }
    button.calculate:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(184, 124, 92, 0.4);
    }
    button.calculate:active {
      transform: translateY(0);
    }

    .result-box {
      background: var(--secondary-bg);
      border-radius: 8px;
      padding: 1rem;
      margin: .75rem 0;
      border-left: 4px solid var(--accent-color);
    }
    .result-label {
      font-size: .85rem;
      text-transform: uppercase;
      letter-spacing: .05em;
      color: var(--secondary-text);
      margin: 0 0 .25rem;
      font-weight: 600;
    }
    .result-value {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--primary-text);
      margin: 0;
    }
    .result-value.highlight {
      font-size: 2.25rem;
      color: var(--accent-color);
    }

    .alert, .notice, .ok { 
      padding: 1rem 1rem 1rem 3.25rem;
      border-radius: 8px;
      margin-top: .75rem;
      position: relative;
      font-size: 1rem;
      line-height: 1.5;
    }
    .alert::before, .notice::before, .ok::before {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.75rem;
    }
    .alert { border-left: 4px solid #b85c5c; background: #fff5f5; }
    .alert strong { color: #b85c5c; }
    .alert::before { content: "‚ö†Ô∏è"; }
    
    .notice { border-left: 4px solid #e0b65f; background: #fffaf0; }
    .notice strong { color: #a5792a; }
    .notice::before { content: "‚ö°"; }
    
    .ok { border-left: 4px solid #4caf50; background: #f0f8f0; }
    .ok strong { color: #2e7d32; }
    .ok::before { content: "‚úÖ"; }

    .footnote { 
      color: var(--secondary-text); 
      font-size: .88rem; 
      margin-top: 1rem;
      padding: .75rem;
      background: var(--secondary-bg);
      border-radius: 6px;
      text-align: center;
    }

    .formula { 
      margin-top: 1.25rem;
      font-size: .9rem;
      color: var(--secondary-text);
      padding: .75rem;
      background: var(--secondary-bg);
      border-radius: 6px;
      border-left: 3px solid var(--border-color);
    }
    .formula code { background: #f7f3ec; padding: .1rem .25rem; border-radius: 4px; }

    /* Collection Type Selection Styles - Compact */
    .collection-types-compact {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.75rem;
      margin-top: 0.5rem;
    }

    .collection-option-compact {
      cursor: pointer;
      display: block;
    }

    .collection-option-compact input[type="checkbox"] {
      display: none;
    }

    .collection-card-compact {
      border: 2px solid var(--border-color);
      border-radius: 6px;
      padding: 0.75rem;
      background: var(--card-bg);
      transition: all 0.2s ease;
      position: relative;
      text-align: center;
      min-height: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .collection-option-compact:hover .collection-card-compact {
      border-color: var(--accent-color);
      box-shadow: 0 2px 6px rgba(184, 124, 92, 0.15);
    }

    .collection-option-compact input[type="checkbox"]:checked + .collection-card-compact {
      border-color: var(--accent-color);
      background: rgba(184, 124, 92, 0.05);
      box-shadow: 0 2px 6px rgba(184, 124, 92, 0.2);
    }

    .collection-option-compact input[type="checkbox"]:checked + .collection-card-compact::after {
      content: "‚úì";
      position: absolute;
      top: 0.25rem;
      right: 0.25rem;
      background: var(--accent-color);
      color: white;
      width: 1.25rem;
      height: 1.25rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: bold;
    }

    .collection-card-compact .collection-icon {
      font-size: 1.5rem;
      margin-bottom: 0.25rem;
    }

    .collection-card-compact .collection-title {
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--primary-text);
      margin: 0;
      line-height: 1.2;
    }

    /* Tool Results Styles */
    .tool-results {
      margin-top: 1rem;
    }

    .tool-section {
      background: var(--secondary-bg);
      border-radius: 6px;
      padding: 0.75rem;
      margin-bottom: 0.75rem;
      border-left: 3px solid var(--accent-color);
    }

    .tool-section h3 {
      margin: 0 0 0.25rem 0;
      font-size: 1rem;
      color: var(--accent-color);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .tool-section p {
      margin: 0 0 0.5rem 0;
      font-size: 0.9rem;
      color: var(--secondary-text);
    }

    .tool-section h3::before {
      font-size: 1.2rem;
    }

    .tool-section.lifetime-calculator h3::before { content: "‚è±Ô∏è"; }
    .tool-section.mold-calculator h3::before { content: "ü¶†"; }
    .tool-section.rh-thresholds h3::before { content: "üéØ"; }
    .tool-section.microclimate-assessment h3::before { content: "üå°Ô∏è"; }
    .tool-section.t-sensitivity-rules h3::before { content: "üìä"; }
    .tool-section.aer-modeling h3::before { content: "üí®"; }
    .tool-section.rh-buffering h3::before { content: "üõ°Ô∏è"; }
    .tool-section.isoperm-diagrams h3::before { content: "üìà"; }
    .tool-section.benchmark-assessment h3::before { content: "üìã"; }

    .tool-placeholder {
      background: #f8f9fa;
      border: 2px dashed #dee2e6;
      border-radius: 6px;
      padding: 1rem;
      text-align: center;
      color: var(--secondary-text);
      font-style: italic;
    }

    .tool-placeholder strong {
      color: var(--accent-color);
      font-style: normal;
    }

    .environmental-criteria {
      background: #f0f8ff;
      border: 1px solid #b3d9ff;
      border-radius: 6px;
      padding: 0.75rem;
      margin-top: 0.5rem;
      font-size: 0.9rem;
    }

    .environmental-criteria h4 {
      margin: 0 0 0.5rem 0;
      color: #1976d2;
      font-size: 0.95rem;
    }

    @media (max-width: 820px) {
      .calculator { grid-template-columns: 1fr; }
      .content { padding: 1.25rem 0.5rem; }
      .environmental-inputs { grid-template-columns: 1fr; }
      .collection-types-compact { grid-template-columns: repeat(2, 1fr); }
    }

    @media (max-width: 480px) {
      .collection-types-compact { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <header>
    <img src="ArchiveSense_logo_text_right.png" alt="ArchiveSense Logo" style="max-width: 300px;">
  </header>

  <nav class="nav">
    <div class="container">
      <a href="/">Home</a>
      <a href="/articles">Articles</a>
      <a href="/preservation-calculator.html">Safe Storage Calculator</a>
      <a href="/tag_generator.html">Tag Generator</a>
    </div>
  </nav>

  <p class="hero-text">How well are you preserving your collection?</p>

  <main class="content">
    <section class="card intro-card" aria-labelledby="about-h2" style="margin-bottom:1.5rem">
      <h2 id="about-h2">üíé Collection Preservation Assessment</h2>
      <p>
        This tool analyzes how environmental conditions impact your collection's longevity. Enter your temperature and humidity measurements, select the materials in your collection, and receive tailored preservation analysis using conservation science models.
      </p>
    </section>
    <section class="calculator" aria-label="Preservation calculator">
      <!-- Compact Input Section -->
      <div class="card inputs-card" aria-labelledby="inputs-h2">
        <h2 id="inputs-h2">Items & Conditions</h2>
        
        <!-- Environmental Inputs - Prominent -->
        <div class="environmental-inputs">
        <div class="field">
            <label for="temp" class="temp-label">Temperature</label>
          <div class="row">
              <input type="number" id="temp" placeholder="20" step="0.1" value="20" aria-describedby="temp-help" />
            <div class="units" role="radiogroup" aria-label="Temperature units">
              <label><input type="radio" name="tempUnit" value="C" checked> ¬∞C</label>
              <label><input type="radio" name="tempUnit" value="F"> ¬∞F</label>
            </div>
          </div>
          </div>

          <div class="field">
            <label for="rh" class="rh-label">Relative Humidity</label>
            <input type="number" id="rh" placeholder="50" min="0" max="100" step="1" value="50" aria-describedby="rh-help" />
          </div>
        </div>

        <!-- Collection Types - Compact Grid -->
        <div class="field">
          <label for="collection-types" class="material-label">Collection Types</label>
          <div id="collection-types" class="collection-types-compact" role="group" aria-describedby="collection-help">
            <label class="collection-option-compact">
              <input type="checkbox" value="paper-documents" data-tools="lifetime-calculator,mold-calculator,isoperm-diagrams">
              <div class="collection-card-compact">
                <div class="collection-icon">üìú</div>
                <div class="collection-title">Paper & Documents</div>
              </div>
            </label>
            
            <label class="collection-option-compact">
              <input type="checkbox" value="film-photographic" data-tools="lifetime-calculator,t-sensitivity-rules">
              <div class="collection-card-compact">
                <div class="collection-icon">üéûÔ∏è</div>
                <div class="collection-title">Film & Photos</div>
              </div>
            </label>
            
            <label class="collection-option-compact">
              <input type="checkbox" value="archaeological-metals" data-tools="rh-thresholds,aer-modeling">
              <div class="collection-card-compact">
                <div class="collection-icon">üè∫</div>
                <div class="collection-title">Metals</div>
              </div>
            </label>
            
            <label class="collection-option-compact">
              <input type="checkbox" value="textiles-fabrics" data-tools="mold-calculator,rh-buffering">
              <div class="collection-card-compact">
                <div class="collection-icon">üßµ</div>
                <div class="collection-title">Textiles</div>
              </div>
            </label>
            
            <label class="collection-option-compact">
              <input type="checkbox" value="fine-art-composites" data-tools="microclimate-assessment,isoperm-diagrams">
              <div class="collection-card-compact">
                <div class="collection-icon">üé®</div>
                <div class="collection-title">Fine Art</div>
              </div>
            </label>
            
            <label class="collection-option-compact">
              <input type="checkbox" value="plastics-polymers" data-tools="lifetime-calculator,benchmark-assessment">
              <div class="collection-card-compact">
                <div class="collection-icon">üî¨</div>
                <div class="collection-title">Plastics</div>
              </div>
            </label>
          </div>
          <small id="collection-help">Select materials in your collection to see tailored preservation analysis.</small>
        </div>

        <div class="field">
          <button class="calculate" id="calculate">üîç Analyze Storage Conditions</button>
        </div>
      </div>

      <!-- Results Section - Prominent -->
      <div class="card results-card" aria-labelledby="results-h2">
        <h2 id="results-h2">Preservation Analysis</h2>
        
        <div id="tool-results" class="tool-results">
          <!-- Tool results will be dynamically populated here -->
        </div>

        <div id="alertArea"></div>

        <details class="formula" style="cursor: pointer;">
          <summary style="font-weight: 600; margin-bottom: .5rem;">üìê Technical Details & Background</summary>
          <div id="technical-details">
            Select collection types to see specific technical models and calculations.
          </div>
          
          <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
            <h4>How Preservation Analysis Works</h4>
            <p>
              Chemical decay in organic materials‚Äîpaper, photographs, textiles, and films‚Äîis driven by both temperature and relative humidity. This tool uses conservation science models to calculate a <strong>lifetime multiplier</strong> for your specific storage conditions, showing how your environment affects your items' permanence relative to the reference standard (20¬∞C, 50% RH).
            </p>
            <p>
              <i>Lifetime Multiple of 1.00 means equivalent lifetime to the reference standard. Higher than 1.00 means better than standard, and lower than 1.00 means worse.</i>
            </p>
            <p>
              The analysis provides predicted lifespan and alerts for mold risk (‚â•65% RH) or low-humidity brittleness (<25% RH). Rule of thumb: each 5¬∞C cooler roughly doubles lifetime; halving RH can double it again.
            </p>
          </div>
        </details>
      </div>
    </section>
  </main>

  <footer class="site-footer" style="text-align:center; padding:2rem; color:var(--secondary-text); border-top:1px solid var(--border-color)">
    <p>¬© ArchiveSense. For educational guidance; always consider object-specific risks.</p>
    <p><a href="/">Home</a> ¬∑ <a href="/articles">Articles</a> ¬∑ <a href="/preservation-calculator.html">Safe Storage Calculator</a> ¬∑ <a href="/tag_generator.html">Tag Generator</a> ¬∑ <a href="/terms">Terms</a> ¬∑ <a href="/privacy">Privacy</a></p>
  </footer>

  <script>
    (function() {
      const R = 8.314; // J/(mol¬∑K)
      
      // Collection type to tools mapping
      const COLLECTION_TOOLS = {
        'paper-documents': ['lifetime-calculator', 'mold-calculator', 'isoperm-diagrams'],
        'film-photographic': ['lifetime-calculator', 't-sensitivity-rules'],
        'archaeological-metals': ['rh-thresholds', 'aer-modeling'],
        'textiles-fabrics': ['mold-calculator', 'rh-buffering'],
        'fine-art-composites': ['microclimate-assessment', 'isoperm-diagrams'],
        'plastics-polymers': ['lifetime-calculator', 'benchmark-assessment']
      };

      // Tool definitions with their implementations
      const TOOL_DEFINITIONS = {
        'lifetime-calculator': {
          name: 'Lifetime Calculator',
          description: 'Calculates material lifetime based on temperature and humidity using Arrhenius equation',
          models: {
            'paper': { Ea: 100000, coeff: 6.17e-19, benchmark: 1000 },
            'film': { Ea: 100000, coeff: 6.17e-19, benchmark: 100 },
            'plastics': { Ea: 70000, coeff: 1e-15, benchmark: 30 }
          }
        },
        'mold-calculator': {
          name: 'Mold Risk Calculator',
          description: 'Assesses mold growth risk based on RH levels and material susceptibility'
        },
        'rh-thresholds': {
          name: 'RH Threshold Monitoring',
          description: 'Monitors RH against critical thresholds for metal corrosion prevention'
        },
        'microclimate-assessment': {
          name: 'Microclimate Assessment',
          description: 'Evaluates RH fluctuation attenuation and air exchange rates'
        },
        't-sensitivity-rules': {
          name: 'Temperature Sensitivity Rules',
          description: 'Applies temperature sensitivity rules for film and photographic materials'
        },
        'aer-modeling': {
          name: 'Air Exchange Rate Modeling',
          description: 'Models air exchange rates for maintaining low RH microclimates'
        },
        'rh-buffering': {
          name: 'RH Buffering Calculation',
          description: 'Calculates RH buffering requirements for textile storage'
        },
        'isoperm-diagrams': {
          name: 'Isoperm/Isochrone Diagrams',
          description: 'Generates isoperm diagrams for material lifetime visualization'
        },
        'benchmark-assessment': {
          name: 'Benchmark Lifetime Assessment',
          description: 'Compares current conditions against benchmark lifetimes for unstable materials'
        }
      };

      // Environmental criteria for each collection type
      const ENVIRONMENTAL_CRITERIA = {
        'paper-documents': {
          rhRange: '30-65%',
          criticalRh: 65,
          tempSensitivity: 'High',
          keyFactors: 'Acid hydrolysis, mold risk at ‚â•65% RH'
        },
        'film-photographic': {
          rhRange: 'Below 60%',
          criticalRh: 60,
          tempSensitivity: 'Very High',
          keyFactors: 'Activation Energy 80-120 kJ/mol, 5¬∞C drop doubles lifetime'
        },
        'archaeological-metals': {
          rhRange: 'Below 30%',
          criticalRh: 30,
          tempSensitivity: 'Moderate',
          keyFactors: 'Bronze disease above 42% RH, iron deterioration above 30% RH'
        },
        'textiles-fabrics': {
          rhRange: '30-65%',
          criticalRh: 65,
          tempSensitivity: 'High',
          keyFactors: 'Hygroscopic materials, mold vulnerability, RH buffering needed'
        },
        'fine-art-composites': {
          rhRange: 'Variable',
          criticalRh: 60,
          tempSensitivity: 'High',
          keyFactors: 'RH fluctuations <1.5% for panel paintings, microclimate sealing'
        },
        'plastics-polymers': {
          rhRange: 'Below 50%',
          criticalRh: 50,
          tempSensitivity: 'Very High',
          keyFactors: 'Activation Energy 60-80 kJ/mol, lifetimes as short as 30 years'
        }
      };

      const tempEl = document.getElementById('temp');
      const rhEl = document.getElementById('rh');
      const calcBtn = document.getElementById('calculate');
      const toolResultsEl = document.getElementById('tool-results');
      const alertArea = document.getElementById('alertArea');
      const technicalDetailsEl = document.getElementById('technical-details');

      function getSelectedUnit() {
        const radios = document.querySelectorAll('input[name="tempUnit"]');
        for (const r of radios) { if (r.checked) return r.value; }
        return 'C';
      }

      function celsiusToKelvin(c) { return c + 273.15; }
      function fahrenheitToKelvin(f) { return (f - 32) * (5/9) + 273.15; }

      function formatYears(years) {
        if (!isFinite(years) || years < 0) return '‚Äî';
        if (years >= 10000) return years.toLocaleString(undefined, { maximumFractionDigits: 0 }) + ' years';
        if (years >= 100) return years.toLocaleString(undefined, { maximumFractionDigits: 0 }) + ' years';
        if (years >= 10) return years.toLocaleString(undefined, { maximumFractionDigits: 1 }) + ' years';
        if (years >= 1) return years.toLocaleString(undefined, { maximumFractionDigits: 2 }) + ' years';
        const months = years * 12;
        if (months >= 1) return months.toLocaleString(undefined, { maximumFractionDigits: 1 }) + ' months';
        const days = years * 365.25;
        return days.toLocaleString(undefined, { maximumFractionDigits: 0 }) + ' days';
      }

      function getSelectedCollectionTypes() {
        const checkboxes = document.querySelectorAll('#collection-types input[type="checkbox"]:checked');
        return Array.from(checkboxes).map(cb => cb.value);
      }

      function getActiveTools(collectionTypes) {
        const tools = new Set();
        collectionTypes.forEach(type => {
          if (COLLECTION_TOOLS[type]) {
            COLLECTION_TOOLS[type].forEach(tool => tools.add(tool));
          }
        });
        return Array.from(tools);
      }

      function calculateLifetimeMultiplier(temp, rh, model) {
        const T = temp + 273.15; // Convert to Kelvin
        const RH = Math.max(0.0001, Math.min(1, rh / 100));
        return model.coeff * Math.exp(model.Ea / (R * T)) * Math.pow(1 / RH, 1.3);
      }

      function renderToolSection(toolId, temp, rh, collectionTypes) {
        const tool = TOOL_DEFINITIONS[toolId];
        if (!tool) return '';

        let content = '';
        
        switch (toolId) {
          case 'lifetime-calculator':
            content = renderLifetimeCalculator(temp, rh, collectionTypes);
            break;
          case 'mold-calculator':
            content = renderMoldCalculator(rh);
            break;
          case 'rh-thresholds':
            content = renderRHThresholds(rh, collectionTypes);
            break;
          case 't-sensitivity-rules':
            content = renderTSensitivityRules(temp, collectionTypes);
            break;
          default:
            content = renderToolPlaceholder(toolId, tool);
        }

        return `
          <div class="tool-section ${toolId}">
            <h3>${tool.name}</h3>
            <p>${tool.description}</p>
            ${content}
          </div>
        `;
      }

      function renderLifetimeCalculator(temp, rh, collectionTypes) {
        let content = '';
        
        // Determine which models to use based on collection types
        const models = [];
        if (collectionTypes.includes('paper-documents')) {
          models.push({ name: 'Paper/Documents', ...TOOL_DEFINITIONS['lifetime-calculator'].models.paper });
        }
        if (collectionTypes.includes('film-photographic') || collectionTypes.includes('plastics-polymers')) {
          models.push({ name: 'Film/Photographic', ...TOOL_DEFINITIONS['lifetime-calculator'].models.film });
        }
        if (collectionTypes.includes('plastics-polymers')) {
          models.push({ name: 'Plastics/Polymers', ...TOOL_DEFINITIONS['lifetime-calculator'].models.plastics });
        }

        models.forEach(model => {
          const multiplier = calculateLifetimeMultiplier(temp, rh, model);
          const predictedYears = model.benchmark * multiplier;
          
          content += `
            <div class="result-box">
              <div class="result-label">${model.name} Lifetime</div>
              <div class="result-value highlight">${formatYears(predictedYears)}</div>
            </div>
            <div class="result-box" style="border-left-color: #6F6558;">
              <div class="result-label">Lifetime Multiplier</div>
              <div class="result-value">√ó ${multiplier.toFixed(2)}</div>
            </div>
            <div class="result-box" style="border-left-color: #6F6558;">
              <div class="result-label">Baseline (Ideal Conditions)</div>
              <div class="result-value">${formatYears(model.benchmark)}</div>
            </div>
          `;
        });

        return content;
      }

      function renderMoldCalculator(rh) {
        let riskLevel, riskColor, riskMessage;
        
        if (rh >= 65) {
          riskLevel = 'HIGH RISK';
          riskColor = '#b85c5c';
          riskMessage = 'Immediate action required - mold growth likely';
        } else if (rh >= 60) {
          riskLevel = 'MODERATE RISK';
          riskColor = '#e0b65f';
          riskMessage = 'Monitor closely - approaching mold threshold';
        } else if (rh >= 50) {
          riskLevel = 'LOW RISK';
          riskColor = '#4caf50';
          riskMessage = 'Generally safe for most materials';
        } else {
          riskLevel = 'VERY LOW RISK';
          riskColor = '#4caf50';
          riskMessage = 'Excellent conditions for mold prevention';
        }

        return `
          <div class="result-box" style="border-left-color: ${riskColor};">
            <div class="result-label">Mold Risk Assessment</div>
            <div class="result-value" style="color: ${riskColor};">${riskLevel}</div>
          </div>
          <div class="result-box">
            <div class="result-label">Current RH</div>
            <div class="result-value">${rh}%</div>
          </div>
          <div class="result-box">
            <div class="result-label">Assessment</div>
            <div class="result-value">${riskMessage}</div>
          </div>
        `;
      }

      function renderRHThresholds(rh, collectionTypes) {
        let content = '';
        
        collectionTypes.forEach(type => {
          const criteria = ENVIRONMENTAL_CRITERIA[type];
          if (criteria) {
            const isCritical = rh > criteria.criticalRh;
            const status = isCritical ? 'CRITICAL' : 'SAFE';
            const color = isCritical ? '#b85c5c' : '#4caf50';
            
            content += `
              <div class="result-box" style="border-left-color: ${color};">
                <div class="result-label">${type.replace('-', ' ').toUpperCase()}</div>
                <div class="result-value" style="color: ${color};">${status}</div>
              </div>
              <div class="environmental-criteria">
                <h4>Environmental Criteria</h4>
                <p><strong>RH Range:</strong> ${criteria.rhRange}</p>
                <p><strong>Critical RH:</strong> ${criteria.criticalRh}%</p>
                <p><strong>Key Factors:</strong> ${criteria.keyFactors}</p>
              </div>
            `;
          }
        });

        return content;
      }

      function renderTSensitivityRules(temp, collectionTypes) {
        const tempDrop = 20 - temp; // Assuming 20¬∞C as reference
        const lifetimeIncrease = Math.pow(2, tempDrop / 5); // Each 5¬∞C doubles lifetime
        
        return `
          <div class="result-box">
            <div class="result-label">Temperature Drop from 20¬∞C</div>
            <div class="result-value">${tempDrop.toFixed(1)}¬∞C</div>
          </div>
          <div class="result-box">
            <div class="result-label">Lifetime Increase Factor</div>
            <div class="result-value">√ó ${lifetimeIncrease.toFixed(2)}</div>
          </div>
          <div class="result-box">
            <div class="result-label">Rule of Thumb</div>
            <div class="result-value">Each 5¬∞C cooler ‚âà doubles lifetime</div>
          </div>
        `;
      }

      function renderToolPlaceholder(toolId, tool) {
        return `
          <div class="tool-placeholder">
            <strong>${tool.name} - Coming Soon</strong><br>
            This evaluation tool is currently under development. 
            The framework is ready for implementation of ${tool.description.toLowerCase()}.
          </div>
        `;
      }

      function renderAlerts(rh, collectionTypes) {
        alertArea.innerHTML = '';
        const alerts = [];

        // General RH alerts
        if (rh >= 65) {
          alerts.push({
            type: 'alert',
            message: '<strong>WARNING: High mold risk</strong> ‚Äî sustained RH ‚â• 65% supports mold growth; reduce RH promptly.'
          });
        } else if (rh >= 60) {
          alerts.push({
            type: 'notice',
            message: '<strong>Caution:</strong> RH > 60% increases risks (blocking in photographs, corrosion, mold potential).'
          });
        } else if (rh < 25) {
          alerts.push({
            type: 'notice',
            message: '<strong>Caution: Low RH</strong> ‚Äî < 25% can embrittle hygroscopic materials (paper, textiles) and increase handling damage.'
          });
        }

        // Collection-specific alerts
        collectionTypes.forEach(type => {
          const criteria = ENVIRONMENTAL_CRITERIA[type];
          if (criteria && rh > criteria.criticalRh) {
            alerts.push({
              type: 'alert',
              message: `<strong>${type.replace('-', ' ').toUpperCase()}: Critical RH exceeded</strong> ‚Äî Current RH (${rh}%) exceeds critical threshold (${criteria.criticalRh}%) for this material type.`
            });
          }
        });

        if (alerts.length === 0) {
          alerts.push({
            type: 'ok',
            message: '<strong>No immediate environmental alerts</strong> ‚Äî conditions are within typical targets for selected collection types.'
          });
        }

        alerts.forEach(alert => {
          const el = document.createElement('div');
          el.className = alert.type;
          el.innerHTML = alert.message;
          alertArea.appendChild(el);
        });
      }

      function updateTechnicalDetails(collectionTypes, activeTools) {
        let content = '';
        
        if (collectionTypes.length === 0) {
          content = 'Select collection types to see specific technical models and calculations.';
        } else {
          content = '<h4>Active Models and Calculations:</h4>';
          
          activeTools.forEach(toolId => {
            const tool = TOOL_DEFINITIONS[toolId];
            content += `<p><strong>${tool.name}:</strong> ${tool.description}</p>`;
          });

          if (activeTools.includes('lifetime-calculator')) {
            content += `
              <br><h4>Lifetime Calculator Formula:</h4>
              <code>t_LM = C √ó exp(Ea / (R √ó T)) √ó (1/RH)<sup>1.3</sup></code><br>
              where <code>T</code> is Kelvin, <code>RH</code> is a fraction, and <code>R = 8.314 J/(mol¬∑K)</code>.
            `;
          }
        }

        technicalDetailsEl.innerHTML = content;
      }

      function calculate() {
        const tempValue = parseFloat(tempEl.value);
        const rhPercent = parseFloat(rhEl.value);
        const unit = getSelectedUnit();
        const collectionTypes = getSelectedCollectionTypes();

        if (!isFinite(tempValue)) { 
          alert('Please enter a valid temperature.'); 
          return; 
        }
        if (!isFinite(rhPercent) || rhPercent < 0 || rhPercent > 100) { 
          alert('RH must be between 0 and 100%.'); 
          return; 
        }

        const temp = unit === 'C' ? tempValue : (tempValue - 32) * (5/9);
        const rh = rhPercent;

        if (collectionTypes.length === 0) {
          // Display message when no collection types are selected
          toolResultsEl.innerHTML = `
            <div class="tool-section">
              <h3>üìã No Collection Types Selected</h3>
              <p>Please select one or more collection types above to see specific evaluation tools and recommendations for your materials.</p>
              <div class="tool-placeholder">
                <strong>Select Collection Types to Begin Analysis</strong><br>
                Each collection type will activate specialized evaluation tools tailored to the environmental sensitivity and preservation requirements of those materials.
              </div>
            </div>
          `;
          alertArea.innerHTML = '';
          technicalDetailsEl.innerHTML = 'Select collection types to see specific technical models and calculations.';
          return;
        }

        const activeTools = getActiveTools(collectionTypes);

        // Render tool results
        let toolResultsHTML = '';
        activeTools.forEach(toolId => {
          toolResultsHTML += renderToolSection(toolId, temp, rh, collectionTypes);
        });

        toolResultsEl.innerHTML = toolResultsHTML;
        renderAlerts(rh, collectionTypes);
        updateTechnicalDetails(collectionTypes, activeTools);
      }

      // Event listeners
      calcBtn.addEventListener('click', calculate);
      
      // Auto-calculate when collection types change
      document.querySelectorAll('#collection-types input[type="checkbox"]').forEach(checkbox => {
        checkbox.addEventListener('change', calculate);
      });

      // Initialize without any default selection
      calculate();
    })();
  </script>
</body>
</html>


